"use strict";(self.webpackChunkomega_cli=self.webpackChunkomega_cli||[]).push([[605],{9605:(Mi,j,p)=>{p.r(j),p.d(j,{ServiceModule:()=>fi,ServiceRoutingModule:()=>fe});var Z=p(4404),f=p(1743),x=p(9783),m=p(2382),v=p(7579),b=(()=>{return(n=b||(b={}))[n.Service=0]="Service",n[n.Category=1]="Category",b;var n})(),Se=p(8979);class Te extends Se.a{constructor(){super()}get fields(){return this.fieldConfigs}}new f.Yd("CreateViewModel");class Ae{constructor(){this.formModel=new Te}}var N=p(655),Ie=p(7642),Ze=p(4185);(0,N.gn)([(0,Ie.z)("isActive")],class Re{constructor(){this.active=null}onMapping(){this.access_level_permissions&&(this.permissions=this.access_level_permissions.map(s=>{var t=new Ze.y(De).map(s.permission);return 1==s.typecode?t.value=[1]:2==s.typecode&&(t.value=[1,2]),t}))}}.prototype,"active",void 0);class De{}var Ee=p(906);class K extends Ee.b{constructor(){super(),this.viewModeItems=[{icon:"pi pi-fw pi-list",command:()=>this.template="listItem"}],this.data=[],this.template="listItem"}get dataKey(){return"id"}get sortfield(){return"number"}get value(){return this.data}get filterFields(){return["number,name"]}get columns(){return this.columnSpec||(this.columnSpec=[],this.columnSpec.push({field:"instock",dataType:"bool",header:"In Stock"}),this.columnSpec.push({field:"number",dataType:"string",header:"Number"}),this.columnSpec.push({field:"name",dataType:"string",header:"Name"}),this.columnSpec.push({field:"alias",dataType:"string",header:"\u4e2d\u6587\u540d"}),this.columnSpec.push({field:"image",dataType:"image",header:"Image"}),this.columnSpec.push({field:"price",dataType:"string",header:"Price($)"})),this.columnSpec}}class ze{constructor(){this.tableModel=new K,this.isVisibleCreateDialog=!1,this.isVisibleEditDialog=!1,this.isVisibleEditImageDialog=!1}}var e=p(5e3),S=p(4146),k=p(72),ee=p(1135);const ke=new f.Yd("StepsService"),Fe=[{stepIndex:1,isComplete:!1},{stepIndex:2,isComplete:!1},{stepIndex:3,isComplete:!1}];let te=(()=>{class n{constructor(){this.steps$=new ee.X(Fe),this.currentStep$=new ee.X(null),this.currentStep$.next(this.steps$.value[0])}reset(){this.steps.forEach(t=>t.forEach(i=>i.isComplete=!1))}setCurrentStep(t){this.currentStep$.next(t)}get currentStep(){return this.currentStep$.asObservable()}get steps(){return this.steps$.asObservable()}moveToNextStep(){const t=this.currentStep$.value.stepIndex;t<this.steps$.value.length&&this.currentStep$.next(this.steps$.value[t])}moveToPreStep(){const t=this.currentStep$.value.stepIndex;ke.debug(t),t>1&&this.currentStep$.next(this.steps$.value[t-2])}isLastStep(){return this.currentStep$.value.stepIndex===this.steps$.value.length}isFirstStep(){return 1===this.currentStep$.value.stepIndex}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();new f.Yd("CreateInteractor");let ie=(()=>{class n{constructor(t,i,o,a,r,c){this.serviceService=t,this.storageService=i,this.messageService=o,this.confirmationService=a,this.spinnerService=r,this.stepsService=c,this.notifierSaved=new v.x,this.subscriptions=[],this.presenter=new Ae,this.permissionMap=new Map}onNextStep(){this.stepsService.isLastStep()?this.presenter.formModel.notifierToSubmit.next(null):this.stepsService.moveToNextStep()}onPreStep(){this.stepsService.isFirstStep()||this.stepsService.moveToPreStep()}onStepClick(t){this.stepsService.setCurrentStep(t)}selectType(t){this.selecteType=t,this.presenter.currentStep.isComplete=!0,t.key===b.Category?this.loadCategoryForm():this.loadServiceForm()}loadServiceForm(){this.presenter.formModel.fieldConfigs=[{type:"text",inputType:"text",name:"name",label:"name",value:"",placeholder:"",validations:[{name:"pattern",validator:m.kI.pattern("^[a-zA-Z]+$"),message:"Accept only text"}]},{type:"number",name:"price",label:"price",value:"",required:!0,currency:{currency:"USD",locale:"en-US"},validations:[{name:"required",validator:m.kI.required,message:"Price Required"}]},{type:"number",name:"duration",label:"Duration",value:"",suffix:" min",required:!0,validations:[{name:"required",validator:m.kI.required,message:"Price Required"}]}]}loadCategoryForm(){this.presenter.formModel.fieldConfigs=[{type:"text",inputType:"text",name:"name",label:"name",value:"",placeholder:"",validations:[{name:"pattern",validator:m.kI.pattern("^[a-zA-Z]+$"),message:"Accept only text"}]}]}selectCategory(t){this.selecteCategory=t,this.presenter.currentStep.isComplete=!0}get nextButtonLabel(){return this.stepsService.isLastStep()?"Finish":"Continue"}get showPreButton(){return!this.stepsService.isFirstStep()}get canSkip(){return 2===this.stepsService.currentStep$.value.stepIndex}loadData(){this.stepsService.reset()}formUpdated(t){this.presenter.currentStep.isComplete=t}subscribeChanges(){this.subscriptions.push(this.stepsService.currentStep.subscribe(t=>{this.presenter.currentStep=t}))}unsubscribeChanges(){this.subscriptions.length&&this.subscriptions.forEach(t=>t.unsubscribe())}submit(t){this.selecteCategory&&(t.category_id=this.selecteCategory.data),t.type=this.selecteType.key,this.serviceService.addService(t).subscribe(i=>{this.messageService.add({severity:"success",summary:"Service Message",detail:"Via MessageService"}),this.notifierSaved.next(null)})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(S.mI),e.LFG(S.Pu),e.LFG(x.ez),e.LFG(x.YP),e.LFG(k.t2),e.LFG(te))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var Q=p(515),B=p(262),F=p(4004);const He=new f.Yd("ListResolverService");let Le=(()=>{class n{constructor(t){this.companyService=t}resolve(t,i){return this.companyService.getCompany(i.url).pipe((0,B.K)(o=>(He.error(o),(0,Q.c)()))).pipe((0,F.U)(o=>({services:o.company.services})))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(S.JN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const T=new f.Yd("ListInteractor");let ne=(()=>{class n{constructor(t,i,o,a,r,c,l,d){this.router=t,this.route=i,this.serviceService=o,this.messageService=a,this.confirmationService=r,this.spinnerService=c,this.companyService=l,this.configService=d,this.notifierToSubmit=new v.x,this.presenter=new ze}loadData(){this.presenter.tableModel.actions.push({type:"switch",label:"Active"}),this.presenter.tableModel.contextMenuItems.push({label:"Edit",icon:"pi pi-pencil",disabled:!1,command:t=>{this.displayEditingDialog(this.presenter.tableModel.contextData)}}),this.presenter.tableModel.contextMenuItems.push({label:"Delete",icon:"pi pi-times",disabled:!1,command:t=>this.confirmDeletion(this.presenter.tableModel.contextData)})}onNodeExpand(t){T.debug("onNodeExpand")}subscribeRouteData(){this.spinnerService.show(),this.route.data.subscribe(t=>{T.debug(t),this.presenter.tableModel.data=this.deepMapping(t.data.services),this.spinnerService.hide()})}confirmDeletion(t){T.debug(this.confirmationService),this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{}})}displayEditingDialog(t){this.selectedItem=t,this.presenter.isVisibleEditDialog=!0}displayCreateDialog(){this.presenter.isVisibleCreateDialog=!0}hideEditingDialog(){this.presenter.isVisibleEditDialog=!1}hideCreateDialog(){this.presenter.isVisibleCreateDialog=!1}saveDialog(t){this.notifierToSubmit.next(t)}cancelDialog(){this.presenter.isVisibleCreateDialog=!1,this.presenter.isVisibleEditDialog=!1}saved(){this.hideCreateDialog(),this.hideEditingDialog(),this.hideUpdateImageDialog(),this.reloadData()}reloadData(){this.spinnerService.show(),this.companyService.getCompany(this.router.url,"network-only").pipe((0,B.K)(t=>(T.error(t),(0,Q.c)()))).pipe((0,F.U)(t=>({services:this.deepMapping(t.company.services)}))).subscribe(t=>{T.debug(t),this.presenter.tableModel.data=t.services,this.spinnerService.hide()})}deepMapping(t){return t.map(i=>{var o={data:{editing:!1,instock:i.instock,id:i.id,name:i.name,alias:i.alias,image:i.image,number:i.number,price:i.type==b.Service?i.price:"",type:i.type},leaf:i.type!=b.Category};return i.children&&(o.children=this.deepMapping(i.children)),o})}getImage(t){return null!=t?this.configService.resourceApiURI+"/ServiceImage/"+t:"assets/images/img_placeholder.png"}displayUpdateImageDialog(t){!t.editing||(this.selectedItem=t,this.presenter.isVisibleEditImageDialog=!0)}hideUpdateImageDialog(){this.presenter.isVisibleEditImageDialog=!1}saveImageDialog(t){this.notifierToSubmit.next(t)}saveRowData(t){T.debug(t)}onRowEditInit(t){t.editing=!0}onRowEditSave(t){t.editing=!1,this.serviceService.updateService(t).subscribe(i=>{T.debug(i),this.messageService.add({severity:"success",summary:"Service Message",detail:"Via MessageService"})})}onRowEditCancel(t){t.editing=!1}filterGlobal(t,i){T.debug(t),T.debug(i.target.value),t.filterGlobal(i.target.value,"contains")}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Z.F0),e.LFG(Z.gz),e.LFG(S.mI),e.LFG(x.ez),e.LFG(x.YP),e.LFG(k.t2),e.LFG(S.JN),e.LFG(S.E4))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var U=p(4534),R=p(845),z=p(9544),u=p(9808),Y=p(2841),q=p(5315),oe=p(9603);function Oe(n,s){if(1&n&&(e.TgZ(0,"span",1),e._UZ(1,"p-radioButton",2),e.TgZ(2,"label",3),e._uU(3),e.qZA(),e.qZA()),2&n){const t=s.$implicit,i=e.oxw();e.xp6(1),e.Q6J("inputId",t.key)("value",t)("formControl",i.itemSelected),e.xp6(1),e.Q6J("for",t.key),e.xp6(1),e.Oqu(t.name)}}new f.Yd("TypeSelectionComponent");let Je=(()=>{class n{constructor(){this.onItemSelected=new e.vpe,this.itemSelected=new m.NI("",m.kI.required),this.types=[{name:"Category",key:b.Category},{name:"Service",key:b.Service}]}ngOnInit(){this.subscription=this.itemSelected.valueChanges.subscribe(t=>{this.onItemSelected.emit(t)}),this.selected&&this.types.forEach(t=>{if(t.key===this.selected.key)return this.selected=t,void this.itemSelected.setValue(t)})}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-type-selection"]],inputs:{selected:"selected"},outputs:{onItemSelected:"onItemSelected"},decls:1,vars:1,consts:[["class","p-field-checkbox",4,"ngFor","ngForOf"],[1,"p-field-checkbox"],[3,"inputId","value","formControl"],[3,"for"]],template:function(t,i){1&t&&e.YNc(0,Oe,4,5,"span",0),2&t&&e.Q6J("ngForOf",i.types)},directives:[u.sg,oe.EU,m.JJ,m.oH],styles:[""]}),n})();var ae=p(4372),re=p(2629);new f.Yd("CategoryTreeComponent");let Ne=(()=>{class n{constructor(t,i){this.companyService=t,this.spinnerService=i,this.onSelected=new e.vpe}ngOnInit(){this.spinnerService.show(),this.companyService.getCompany("category-tree").pipe((0,F.U)(t=>{const o=a=>{var r=[];return a.forEach(c=>{if(c.type!=b.Service){var l={expandedIcon:"pi pi-folder-open",collapsedIcon:"pi pi-folder"};r.push(l),l.label=c.name,l.data=c.id,c.children&&(l.children=o(c.children))}}),r};return o(t.company.services)})).subscribe(t=>{this.setCategories(t),this.spinnerService.hide()})}setCategories(t){if(this.categories=t,this.selected){const i=(a,r)=>{a.forEach(c=>{r&&(c.parent=r),c.data!==this.selected.data?c.children&&i(c.children,c):this.selected=c})};i(this.categories,null);const o=a=>{a.parent&&(a.parent.expanded=!0,o(a.parent))};o(this.selected),this.onSelected.emit(this.selected)}}nodeSelect(t){this.onSelected.emit(t.node)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ae.JN),e.Y36(k.t2))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-category-tree"]],inputs:{selected:"selected"},outputs:{onSelected:"onSelected"},decls:1,vars:4,consts:[["name","categorySelectionTree","selectionMode","single",3,"value","selection","propagateSelectionUp","propagateSelectionDown","selectionChange","onNodeSelect"]],template:function(t,i){1&t&&(e.TgZ(0,"p-tree",0),e.NdJ("selectionChange",function(a){return i.selected=a})("onNodeSelect",function(a){return i.nodeSelect(a)}),e.qZA()),2&t&&e.Q6J("value",i.categories)("selection",i.selected)("propagateSelectionUp",!1)("propagateSelectionDown",!1)},directives:[re.mp],styles:[""]}),n})();var se=p(2193);function Qe(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"p"),e._uU(2,"What do you want to create?"),e.qZA(),e.TgZ(3,"app-type-selection",10),e.NdJ("onItemSelected",function(o){return e.CHM(t),e.oxw().interactor.selectType(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("selected",t.interactor.selecteType)}}function Be(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"p"),e._uU(2,"Where do you want to create?"),e.qZA(),e.TgZ(3,"app-category-tree",11),e.NdJ("onSelected",function(o){return e.CHM(t),e.oxw().interactor.selectCategory(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("selected",t.interactor.selecteCategory)}}function Ue(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-dynamic-form-builder-component",12),e.NdJ("formUpdated",function(o){return e.CHM(t),e.oxw().interactor.formUpdated(o)})("submit",function(o){return e.CHM(t),e.oxw().interactor.submit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("model",t.viewModel.formModel)("isCancelVisible",!1)}}function Ye(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){return e.CHM(t),e.oxw().interactor.onPreStep()}),e.qZA()}}function qe(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().interactor.onNextStep()}),e.qZA()}}new f.Yd("CreateComponent");let ce=(()=>{class n{constructor(t){this.interactor=t,this.notifierToSubmit=new v.x,this.saved=new v.x}ngOnInit(){this.interactor.notifierSaved=this.saved,this.viewModel=this.interactor.presenter,this.viewModel.formModel.notifierToSubmit=this.notifierToSubmit,this.interactor.loadData(),this.interactor.subscribeChanges()}ngOnDestroy(){this.interactor.unsubscribeChanges()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ie))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create"]],inputs:{notifierToSubmit:"notifierToSubmit"},outputs:{saved:"saved"},features:[e._Bn([te,ie])],decls:14,vars:8,consts:[[1,"form-page-container"],[1,"step-page-container"],[1,"form-step"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"p-fluid","p-formgrid","p-grid"],[1,"p-field","p-col"],["pButton","","pRipple","","label","Back","class","p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","","label","Skip","class","p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","",1,"p-button-text",3,"label","disabled","click"],[3,"selected","onItemSelected"],[3,"selected","onSelected"],[3,"model","isCancelVisible","formUpdated","submit"],["pButton","","pRipple","","label","Back",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Skip",1,"p-button-text",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.ynx(3,3),e.YNc(4,Qe,4,1,"ng-container",4),e.YNc(5,Be,4,1,"ng-container",4),e.YNc(6,Ue,2,2,"ng-container",4),e.BQk(),e.qZA(),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.YNc(9,Ye,1,0,"button",7),e.qZA(),e.TgZ(10,"div",6),e.YNc(11,qe,1,0,"button",8),e.qZA(),e.TgZ(12,"div",6),e.TgZ(13,"button",9),e.NdJ("click",function(){return i.interactor.onNextStep()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngSwitch",null==i.viewModel.currentStep?null:i.viewModel.currentStep.stepIndex),e.xp6(1),e.Q6J("ngSwitchCase","1"),e.xp6(1),e.Q6J("ngSwitchCase","2"),e.xp6(1),e.Q6J("ngSwitchCase","3"),e.xp6(3),e.Q6J("ngIf",i.interactor.showPreButton),e.xp6(2),e.Q6J("ngIf",i.interactor.canSkip),e.xp6(2),e.s9C("label",i.interactor.nextButtonLabel),e.Q6J("disabled",!(null!=i.viewModel.currentStep&&i.viewModel.currentStep.isComplete)))},directives:[u.RF,u.n9,Je,Ne,se.U,u.O5,R.Hq],styles:[".form-page-container{display:flex;flex-direction:column;height:100%;width:100%}.step-page-container{flex:1;margin:0 32px}.form-continue-btn{background:#3e709b;margin:32px}.form-continue-btn:disabled{opacity:.5;cursor:not-allowed!important}.common-btn{color:#fff;background:#3e709b;padding:20px;border-radius:50px;font-size:1.15em;cursor:pointer;border:none!important}\n"],encapsulation:2}),n})(),le=(()=>{class n{constructor(){this.notifierToSubmit=new v.x,this.saved=new v.x}ngOnInit(){}ngOnDestroy(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-edit"]],inputs:{notifierToSubmit:"notifierToSubmit",item:"item"},outputs:{saved:"saved"},decls:4,vars:2,consts:[[1,"p-grid"],[1,"p-col-12"],[1,"card"],[3,"model","isCancelVisible"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"app-dynamic-form-builder-component",3),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("model",i.viewModel.formModel)("isCancelVisible",!1))},directives:[se.U],styles:[""]}),n})();class We{constructor(){this.notifierToSubmit=new v.x,this.croppedImage="",this.imageChangedEvent=""}}new f.Yd("UpdateImageInteractor");let pe=(()=>{class n{constructor(t){this.serviceService=t,this.notifierSaved=new v.x,this.subscriptions=[],this.presenter=new We}subscribeChanges(){this.subscriptions.push(this.presenter.notifierToSubmit.subscribe(t=>{this.subscriptions.push(this.serviceService.updateServiceImage({service_id:this.localData.id,image_base64:this.presenter.croppedImage}).subscribe(i=>{this.notifierSaved.next(null)}))}))}loadData(){}fileChangeEvent(t){this.presenter.imageChangedEvent=t}imageCropped(t){this.presenter.croppedImage=t.base64}imageLoaded(t){}cropperReady(t){}loadImageFailed(t){}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(ae.mI))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var Ve=p(2313);const $e=["wrapper"],Ge=["sourceImage"];function Xe(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"img",4,5),e.NdJ("load",function(){return e.CHM(t),e.oxw().imageLoadedInView()}),e.qZA()}if(2&n){const t=e.oxw();e.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),e.Q6J("src",t.safeImgDataUrl,e.LSH)}}function Pe(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",9),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"topleft")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"topleft")}),e._UZ(2,"span",10),e.qZA(),e.TgZ(3,"span",11),e._UZ(4,"span",10),e.qZA(),e.TgZ(5,"span",12),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"topright")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"topright")}),e._UZ(6,"span",10),e.qZA(),e.TgZ(7,"span",13),e._UZ(8,"span",10),e.qZA(),e.TgZ(9,"span",14),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"bottomright")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"bottomright")}),e._UZ(10,"span",10),e.qZA(),e.TgZ(11,"span",15),e._UZ(12,"span",10),e.qZA(),e.TgZ(13,"span",16),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"bottomleft")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"bottomleft")}),e._UZ(14,"span",10),e.qZA(),e.TgZ(15,"span",17),e._UZ(16,"span",10),e.qZA(),e.TgZ(17,"span",18),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"top")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"top")}),e.qZA(),e.TgZ(18,"span",19),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"right")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"right")}),e.qZA(),e.TgZ(19,"span",20),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"bottom")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"bottom")}),e.qZA(),e.TgZ(20,"span",21),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"left")})("touchstart",function(o){e.CHM(t);const a=e.oxw(2);return a.startMove(o,a.moveTypes.Resize,"left")}),e.qZA(),e.BQk()}}function je(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("keydown",function(o){return e.CHM(t),e.oxw().keyboardAccess(o)}),e.TgZ(1,"div",7),e.NdJ("mousedown",function(o){e.CHM(t);const a=e.oxw();return a.startMove(o,a.moveTypes.Move)})("touchstart",function(o){e.CHM(t);const a=e.oxw();return a.startMove(o,a.moveTypes.Move)}),e.qZA(),e.YNc(2,Pe,21,0,"ng-container",8),e.qZA()}if(2&n){const t=e.oxw();e.Udp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),e.ekj("ngx-ic-round",t.roundCropper),e.xp6(2),e.Q6J("ngIf",!t.hideResizeSquares)}}class Ke{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(s){Object.keys(s).filter(t=>t in this).forEach(t=>this[t]=s[t]),this.validateOptions()}setOptionsFromChanges(s){Object.keys(s).filter(t=>t in this).forEach(t=>this[t]=s[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var C=(()=>{return(n=C||(C={})).Move="move",n.Resize="resize",n.Pinch="pinch",C;var n})();let ot=(()=>{class n{crop(t,i,o,a){const r=this.getImagePosition(t,i,o,a),c=r.x2-r.x1,l=r.y2-r.y1,d=document.createElement("canvas");d.width=c,d.height=l;const g=d.getContext("2d");if(!g)return null;null!=a.backgroundColor&&(g.fillStyle=a.backgroundColor,g.fillRect(0,0,c,l));const h=(a.transform.scale||1)*(a.transform.flipH?-1:1),A=(a.transform.scale||1)*(a.transform.flipV?-1:1),M=i.transformed;g.setTransform(h,0,0,A,M.size.width/2,M.size.height/2),g.translate(-r.x1/h,-r.y1/A),g.rotate((a.transform.rotate||0)*Math.PI/180),g.drawImage(M.image,-M.size.width/2,-M.size.height/2);const _={width:c,height:l,imagePosition:r,cropperPosition:Object.assign({},o)};a.containWithinAspectRatio&&(_.offsetImagePosition=this.getOffsetImagePosition(t,i,o,a));const w=this.getResizeRatio(c,l,a);return 1!==w&&(_.width=Math.round(c*w),_.height=a.maintainAspectRatio?Math.round(_.width/a.aspectRatio):Math.round(l*w),function nt(n,s,t){const i=n.width,o=n.height,a=i/(s=Math.round(s)),r=o/(t=Math.round(t)),c=Math.ceil(a/2),l=Math.ceil(r/2),d=n.getContext("2d");if(d){const g=d.getImageData(0,0,i,o),h=d.createImageData(s,t),A=g.data,M=h.data;for(let _=0;_<t;_++)for(let w=0;w<s;w++){const H=4*(w+_*s),xi=_*r;let I=0,L=0,xe=0,ve=0,Ce=0,be=0,ye=0;const vi=Math.floor(w*a),Ci=Math.floor(_*r);let X=Math.ceil((w+1)*a),P=Math.ceil((_+1)*r);X=Math.min(X,i),P=Math.min(P,o);for(let O=Ci;O<P;O++){const Me=Math.abs(xi-O)/l,bi=w*a,yi=Me*Me;for(let J=vi;J<X;J++){const we=Math.abs(bi-J)/c,D=Math.sqrt(yi+we*we);if(D>=1)continue;I=2*D*D*D-3*D*D+1;const E=4*(J+O*i);ye+=I*A[E+3],xe+=I,A[E+3]<255&&(I=I*A[E+3]/250),ve+=I*A[E],Ce+=I*A[E+1],be+=I*A[E+2],L+=I}}M[H]=ve/L,M[H+1]=Ce/L,M[H+2]=be/L,M[H+3]=ye/xe}n.width=s,n.height=t,d.putImageData(h,0,0)}}(d,_.width,_.height)),_.base64=d.toDataURL("image/"+a.format,this.getQuality(a)),_}getImagePosition(t,i,o,a){const c=i.transformed.size.width/t.nativeElement.offsetWidth,l={x1:Math.round(o.x1*c),y1:Math.round(o.y1*c),x2:Math.round(o.x2*c),y2:Math.round(o.y2*c)};return a.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,i.transformed.size.width),l.y2=Math.min(l.y2,i.transformed.size.height)),l}getOffsetImagePosition(t,i,o,a){const l=i.transformed.size.width/t.nativeElement.offsetWidth;let d,g;(a.canvasRotation+i.exifTransform.rotate)%2?(d=(i.transformed.size.width-i.original.size.height)/2,g=(i.transformed.size.height-i.original.size.width)/2):(d=(i.transformed.size.width-i.original.size.width)/2,g=(i.transformed.size.height-i.original.size.height)/2);const h={x1:Math.round(o.x1*l)-d,y1:Math.round(o.y1*l)-g,x2:Math.round(o.x2*l)-d,y2:Math.round(o.y2*l)-g};return a.containWithinAspectRatio||(h.x1=Math.max(h.x1,0),h.y1=Math.max(h.y1,0),h.x2=Math.min(h.x2,i.transformed.size.width),h.y2=Math.min(h.y2,i.transformed.size.height)),h}getResizeRatio(t,i,o){const a=o.resizeToWidth/t,r=o.resizeToHeight/i,c=new Array;o.resizeToWidth>0&&c.push(a),o.resizeToHeight>0&&c.push(r);const l=0===c.length?1:Math.min(...c);return l>1&&!o.onlyScaleDown?l:Math.min(l,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),at=(()=>{class n{resetCropperPosition(t,i,o){if(!(null==t?void 0:t.nativeElement))return;const a=t.nativeElement;if(o.cropperStaticHeight&&o.cropperStaticWidth)i.x1=0,i.x2=a.offsetWidth>o.cropperStaticWidth?o.cropperStaticWidth:a.offsetWidth,i.y1=0,i.y2=a.offsetHeight>o.cropperStaticHeight?o.cropperStaticHeight:a.offsetHeight;else{const r=Math.min(o.cropperScaledMaxWidth,a.offsetWidth),c=Math.min(o.cropperScaledMaxHeight,a.offsetHeight);if(o.maintainAspectRatio)if(a.offsetWidth/o.aspectRatio<a.offsetHeight){i.x1=0,i.x2=r;const l=r/o.aspectRatio;i.y1=(a.offsetHeight-l)/2,i.y2=i.y1+l}else{i.y1=0,i.y2=c;const l=c*o.aspectRatio;i.x1=(a.offsetWidth-l)/2,i.x2=i.x1+l}else i.x1=0,i.x2=r,i.y1=0,i.y2=c}}move(t,i,o){const a=this.getClientX(t)-i.clientX,r=this.getClientY(t)-i.clientY;o.x1=i.x1+a,o.y1=i.y1+r,o.x2=i.x2+a,o.y2=i.y2+r}resize(t,i,o,a,r){const c=this.getClientX(t)-i.clientX,l=this.getClientY(t)-i.clientY;switch(i.position){case"left":o.x1=Math.min(Math.max(i.x1+c,o.x2-r.cropperScaledMaxWidth),o.x2-r.cropperScaledMinWidth);break;case"topleft":o.x1=Math.min(Math.max(i.x1+c,o.x2-r.cropperScaledMaxWidth),o.x2-r.cropperScaledMinWidth),o.y1=Math.min(Math.max(i.y1+l,o.y2-r.cropperScaledMaxHeight),o.y2-r.cropperScaledMinHeight);break;case"top":o.y1=Math.min(Math.max(i.y1+l,o.y2-r.cropperScaledMaxHeight),o.y2-r.cropperScaledMinHeight);break;case"topright":o.x2=Math.max(Math.min(i.x2+c,o.x1+r.cropperScaledMaxWidth),o.x1+r.cropperScaledMinWidth),o.y1=Math.min(Math.max(i.y1+l,o.y2-r.cropperScaledMaxHeight),o.y2-r.cropperScaledMinHeight);break;case"right":o.x2=Math.max(Math.min(i.x2+c,o.x1+r.cropperScaledMaxWidth),o.x1+r.cropperScaledMinWidth);break;case"bottomright":o.x2=Math.max(Math.min(i.x2+c,o.x1+r.cropperScaledMaxWidth),o.x1+r.cropperScaledMinWidth),o.y2=Math.max(Math.min(i.y2+l,o.y1+r.cropperScaledMaxHeight),o.y1+r.cropperScaledMinHeight);break;case"bottom":o.y2=Math.max(Math.min(i.y2+l,o.y1+r.cropperScaledMaxHeight),o.y1+r.cropperScaledMinHeight);break;case"bottomleft":o.x1=Math.min(Math.max(i.x1+c,o.x2-r.cropperScaledMaxWidth),o.x2-r.cropperScaledMinWidth),o.y2=Math.max(Math.min(i.y2+l,o.y1+r.cropperScaledMaxHeight),o.y1+r.cropperScaledMinHeight);break;case"center":const d=t.scale,g=Math.min(Math.max(r.cropperScaledMinWidth,Math.abs(i.x2-i.x1)*d),r.cropperScaledMaxWidth),h=Math.min(Math.max(r.cropperScaledMinHeight,Math.abs(i.y2-i.y1)*d),r.cropperScaledMaxHeight);o.x1=i.clientX-g/2,o.x2=i.clientX+g/2,o.y1=i.clientY-h/2,o.y2=i.clientY+h/2,o.x1<0?(o.x2-=o.x1,o.x1=0):o.x2>a.width&&(o.x1-=o.x2-a.width,o.x2=a.width),o.y1<0?(o.y2-=o.y1,o.y1=0):o.y2>a.height&&(o.y1-=o.y2-a.height,o.y2=a.height)}r.maintainAspectRatio&&this.checkAspectRatio(i.position,o,a,r)}checkAspectRatio(t,i,o,a){let r=0,c=0;switch(t){case"top":i.x2=i.x1+(i.y2-i.y1)*a.aspectRatio,r=Math.max(i.x2-o.width,0),c=Math.max(0-i.y1,0),(r>0||c>0)&&(i.x2-=c*a.aspectRatio>r?c*a.aspectRatio:r,i.y1+=c*a.aspectRatio>r?c:r/a.aspectRatio);break;case"bottom":i.x2=i.x1+(i.y2-i.y1)*a.aspectRatio,r=Math.max(i.x2-o.width,0),c=Math.max(i.y2-o.height,0),(r>0||c>0)&&(i.x2-=c*a.aspectRatio>r?c*a.aspectRatio:r,i.y2-=c*a.aspectRatio>r?c:r/a.aspectRatio);break;case"topleft":i.y1=i.y2-(i.x2-i.x1)/a.aspectRatio,r=Math.max(0-i.x1,0),c=Math.max(0-i.y1,0),(r>0||c>0)&&(i.x1+=c*a.aspectRatio>r?c*a.aspectRatio:r,i.y1+=c*a.aspectRatio>r?c:r/a.aspectRatio);break;case"topright":i.y1=i.y2-(i.x2-i.x1)/a.aspectRatio,r=Math.max(i.x2-o.width,0),c=Math.max(0-i.y1,0),(r>0||c>0)&&(i.x2-=c*a.aspectRatio>r?c*a.aspectRatio:r,i.y1+=c*a.aspectRatio>r?c:r/a.aspectRatio);break;case"right":case"bottomright":i.y2=i.y1+(i.x2-i.x1)/a.aspectRatio,r=Math.max(i.x2-o.width,0),c=Math.max(i.y2-o.height,0),(r>0||c>0)&&(i.x2-=c*a.aspectRatio>r?c*a.aspectRatio:r,i.y2-=c*a.aspectRatio>r?c:r/a.aspectRatio);break;case"left":case"bottomleft":i.y2=i.y1+(i.x2-i.x1)/a.aspectRatio,r=Math.max(0-i.x1,0),c=Math.max(i.y2-o.height,0),(r>0||c>0)&&(i.x1+=c*a.aspectRatio>r?c*a.aspectRatio:r,i.y2-=c*a.aspectRatio>r?c:r/a.aspectRatio);break;case"center":i.x2=i.x1+(i.y2-i.y1)*a.aspectRatio,i.y2=i.y1+(i.x2-i.x1)/a.aspectRatio;const l=Math.max(0-i.x1,0),d=Math.max(i.x2-o.width,0),g=Math.max(i.y2-o.height,0),h=Math.max(0-i.y1,0);(l>0||d>0||g>0||h>0)&&(i.x1+=g*a.aspectRatio>l?g*a.aspectRatio:l,i.x2-=h*a.aspectRatio>d?h*a.aspectRatio:d,i.y1+=h*a.aspectRatio>d?h:d/a.aspectRatio,i.y2-=g*a.aspectRatio>l?g:l/a.aspectRatio)}}getClientX(t){var i;return(null===(i=t.touches)||void 0===i?void 0:i[0].clientX)||t.clientX||0}getClientY(t){var i;return(null===(i=t.touches)||void 0===i?void 0:i[0].clientY)||t.clientY||0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let dt=(()=>{class n{constructor(){this.autoRotateSupported=function st(){return new Promise(n=>{const s=new Image;s.onload=()=>{n(1===s.width&&2===s.height)},s.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,i){return new Promise((o,a)=>{const r=new FileReader;r.onload=c=>{this.loadImage(c.target.result,t.type,i).then(o).catch(a)},r.readAsDataURL(t)})}loadImage(t,i,o){return this.isValidImageType(i)?this.loadBase64Image(t,o):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,i){return new Promise((o,a)=>{const r=new Image;r.onerror=()=>a,r.onload=()=>{const c=document.createElement("canvas"),l=c.getContext("2d");c.width=r.width,c.height=r.height,null==l||l.drawImage(r,0,0),this.loadBase64Image(c.toDataURL(),i).then(o)},r.crossOrigin="anonymous",r.src=t})}loadBase64Image(t,i){return new Promise((o,a)=>{const r=new Image;r.onload=()=>o({originalImage:r,originalBase64:t}),r.onerror=a,r.src=t}).then(o=>this.transformImageBase64(o,i))}transformImageBase64(t,i){return(0,N.mG)(this,void 0,void 0,function*(){const o=yield this.autoRotateSupported,a=yield function ct(n){switch("string"==typeof n&&(n=function lt(n){const s=new DataView(function pt(n){n=n.replace(/^data\:([^\;]+)\;base64,/gim,"");const s=atob(n),t=s.length,i=new Uint8Array(t);for(let o=0;o<t;o++)i[o]=s.charCodeAt(o);return i.buffer}(n));if(65496!==s.getUint16(0,!1))return-2;const t=s.byteLength;let i=2;for(;i<t;){if(s.getUint16(i+2,!1)<=8)return-1;const o=s.getUint16(i,!1);if(i+=2,65505==o){if(1165519206!==s.getUint32(i+=2,!1))return-1;const a=18761==s.getUint16(i+=6,!1);i+=s.getUint32(i+4,a);const r=s.getUint16(i,a);i+=2;for(let c=0;c<r;c++)if(274==s.getUint16(i+12*c,a))return s.getUint16(i+12*c+8,a)}else{if(65280!=(65280&o))break;i+=s.getUint16(i,!1)}}return-1}(n)),n){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(o?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?this.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:a},i):Promise.reject(new Error("No image loaded"))})}transformLoadedImage(t,i){return(0,N.mG)(this,void 0,void 0,function*(){const o=i.canvasRotation+t.exifTransform.rotate,a={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===o&&!t.exifTransform.flip&&!i.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},a)},transformed:{base64:t.original.base64,image:t.original.image,size:Object.assign({},a)},exifTransform:t.exifTransform};const r=this.getTransformedSize(a,t.exifTransform,i),c=document.createElement("canvas");c.width=r.width,c.height=r.height;const l=c.getContext("2d");null==l||l.setTransform(t.exifTransform.flip?-1:1,0,0,1,c.width/2,c.height/2),null==l||l.rotate(Math.PI*(o/2)),null==l||l.drawImage(t.original.image,-a.width/2,-a.height/2);const d=c.toDataURL(),g=yield this.loadImageFromBase64(d);return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},a)},transformed:{base64:d,image:g,size:{width:g.width,height:g.height}},exifTransform:t.exifTransform}})}loadImageFromBase64(t){return new Promise((i,o)=>{const a=new Image;a.onload=()=>i(a),a.onerror=o,a.src=t})}getTransformedSize(t,i,o){const a=o.canvasRotation+i.rotate;if(o.containWithinAspectRatio){if(a%2){const c=t.height/o.aspectRatio;return{width:Math.max(t.height,t.width*o.aspectRatio),height:Math.max(t.width,c)}}{const c=t.width/o.aspectRatio;return{width:Math.max(t.width,t.height*o.aspectRatio),height:Math.max(t.height,c)}}}return a%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gt=(()=>{class n{constructor(t,i,o,a,r){this.cropService=t,this.cropperPositionService=i,this.loadImageService=o,this.sanitizer=a,this.cd=r,this.Hammer=(null==window?void 0:window.Hammer)||null,this.settings=new Ke,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=C,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new e.vpe,this.startCropImage=new e.vpe,this.imageLoaded=new e.vpe,this.cropperReady=new e.vpe,this.loadImageFailed=new e.vpe,this.reset()}ngOnChanges(t){var i;this.onChangesUpdateSettings(t),this.onChangesInputImage(t),(null===(i=this.loadedImage)||void 0===i?void 0:i.original.image.complete)&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(o=>this.setLoadedImage(o)).catch(o=>this.loadImageError(o)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(t.maintainAspectRatio||t.aspectRatio)?this.resetCropperPosition():t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var t,i,o;return(null===(o=null===(i=null===(t=this.imageChangedEvent)||void 0===t?void 0:t.target)||void 0===i?void 0:i.files)||void 0===o?void 0:o.length)>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var t,i;return(null===(i=null===(t=this.sourceImage)||void 0===t?void 0:t.nativeElement)||void 0===i?void 0:i.offsetWidth)>0}onResize(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,e.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const i=+t.key;i>=1&&i<=9&&(this.settings.stepSize=i)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const o=t.shiftKey?C.Resize:C.Move,a=t.altKey?function tt(n){switch(n){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function et(n){switch(n){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),r=function it(n,s){switch(n){case"ArrowUp":return{clientX:0,clientY:-1*s};case"ArrowRight":return{clientX:s,clientY:0};case"ArrowDown":return{clientX:0,clientY:s};default:return{clientX:-1*s,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},o,a),this.moveImg(r),this.moveStop()}startMove(t,i,o=null){var a,r;(null===(a=this.moveStart)||void 0===a?void 0:a.active)&&(null===(r=this.moveStart)||void 0===r?void 0:r.type)===C.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:i,position:o,clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t)},this.cropper))}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:C.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}moveImg(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===C.Move?(this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===C.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===C.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){var t,i;(null===(i=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===i?void 0:i.image)?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){var t,i;if(null===(i=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===i?void 0:i.image){const o=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/o:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/o:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){var t,i;if(null!=(null===(i=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===i?void 0:i.image)){this.startCropImage.emit();const o=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=o&&this.imageCropped.emit(o),o}return null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ot),e.Y36(at),e.Y36(dt),e.Y36(Ve.H7),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["image-cropper"]],viewQuery:function(t,i){if(1&t&&(e.Gf($e,7),e.Gf(Ge,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.wrapper=o.first),e.iGM(o=e.CRH())&&(i.sourceImage=o.first)}},hostVars:4,hostBindings:function(t,i){1&t&&e.NdJ("resize",function(){return i.onResize()},!1,e.Jf7)("mousemove",function(a){return i.moveImg(a)},!1,e.evT)("touchmove",function(a){return i.moveImg(a)},!1,e.evT)("mouseup",function(){return i.moveStop()},!1,e.evT)("touchend",function(){return i.moveStop()},!1,e.evT),2&t&&(e.Udp("text-align",i.alignImage),e.ekj("disabled",i.disabled))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[e.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,i){1&t&&(e.TgZ(0,"div",null,0),e.YNc(2,Xe,2,5,"img",1),e._UZ(3,"div",2),e.YNc(4,je,3,15,"div",3),e.qZA()),2&t&&(e.Udp("background",i.imageVisible&&i.backgroundColor),e.xp6(2),e.Q6J("ngIf",i.safeImgDataUrl),e.xp6(1),e.Udp("width",i.maxSize.width,"px")("height",i.maxSize.height,"px")("margin-left","center"===i.alignImage?i.marginLeft:null),e.xp6(1),e.Q6J("ngIf",i.imageVisible))},directives:[u.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),n})(),ht=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[u.ez]]}),n})();new f.Yd("EditImageComponent");let de=(()=>{class n{constructor(t){this.interactor=t,this.notifierToSubmit=new v.x,this.saved=new v.x}ngOnInit(){this.interactor.notifierSaved=this.saved,this.viewModel=this.interactor.presenter,this.interactor.localData=this.item,this.viewModel.notifierToSubmit=this.notifierToSubmit,this.interactor.loadData(),this.interactor.subscribeChanges()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(pe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-update-image"]],inputs:{notifierToSubmit:"notifierToSubmit",item:"item"},outputs:{saved:"saved"},features:[e._Bn([pe])],decls:7,vars:4,consts:[["type","file",3,"change"],[1,"grid"],[1,"col-8"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"col-4"],[3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"input",0),e.NdJ("change",function(a){return i.interactor.fileChangeEvent(a)}),e.qZA(),e.qZA(),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"image-cropper",3),e.NdJ("imageCropped",function(a){return i.interactor.imageCropped(a)})("imageLoaded",function(a){return i.interactor.imageLoaded(a)})("cropperReady",function(a){return i.interactor.cropperReady(a)})("loadImageFailed",function(a){return i.interactor.loadImageFailed(a)}),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e._UZ(6,"img",5),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("imageChangedEvent",i.viewModel.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",1),e.xp6(2),e.Q6J("src",i.viewModel.croppedImage,e.LSH))},directives:[gt],styles:["img[_ngcontent-%COMP%]{max-width:100%;padding:5px}"]}),n})();var W=p(9114);function mt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",15),e._UZ(1,"i",16),e.TgZ(2,"input",17),e.NdJ("input",function(o){e.CHM(t);const a=e.oxw(),r=e.MAs(7);return a.interactor.filterGlobal(r,o)}),e.qZA(),e.qZA()}}const ut=function(n){return{width:n}};function _t(n,s){if(1&n&&(e.TgZ(0,"th",20),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("ngStyle",e.VKq(2,ut,"Name"===t.header?"4rem":"2rem")),e.xp6(1),e.hij(" ",t.header," ")}}function ft(n,s){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,_t,2,4,"th",18),e._UZ(2,"th",19),e.qZA()),2&n){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function xt(n,s){if(1&n&&e._UZ(0,"p-treeTableToggler",30),2&n){const t=e.oxw(2).$implicit;e.Q6J("rowNode",t)}}function vt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"p-toggleButton",31),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().rowData[a.field]=o}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw().rowData;e.Q6J("disabled",!i.editing)("ngModel",i[t.field])}}function Ct(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"img",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3).rowData;return e.oxw().interactor.displayUpdateImageDialog(o)}),e.qZA()}if(2&n){const t=e.oxw(3).rowData,i=e.oxw();e.s9C("src",i.interactor.getImage(t.image),e.LSH),e.Q6J("alt",t.name)}}function bt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"input",40),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(5).$implicit;return e.oxw().rowData[a.field]=o}),e.qZA()}if(2&n){const t=e.oxw(5).$implicit,i=e.oxw().rowData;e.Q6J("ngModel",i[t.field])}}function yt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"input",41),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(5).$implicit;return e.oxw().rowData[a.field]=o}),e.qZA()}if(2&n){const t=e.oxw(5).$implicit,i=e.oxw().rowData;e.Q6J("ngModel",i[t.field])}}function Mt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"textarea",42),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(5).$implicit;return e.oxw().rowData[a.field]=o}),e.qZA()}if(2&n){const t=e.oxw(5).$implicit,i=e.oxw().rowData;e.Q6J("ngModel",i[t.field])}}function wt(n,s){if(1&n&&(e.YNc(0,bt,1,1,"input",37),e.YNc(1,yt,1,1,"input",38),e.YNc(2,Mt,1,1,"textarea",39)),2&n){const t=e.oxw(4).$implicit;e.Q6J("ngIf","price"==t.field),e.xp6(1),e.Q6J("ngIf","price"!=t.field&&"name"!=t.field),e.xp6(1),e.Q6J("ngIf","name"==t.field)}}function St(n,s){if(1&n&&e._uU(0),2&n){const t=e.oxw(4).$implicit,i=e.oxw().rowData;e.Oqu(i[t.field])}}function Tt(n,s){1&n&&(e.TgZ(0,"p-treeTableCellEditor"),e.YNc(1,wt,3,3,"ng-template",35),e.YNc(2,St,1,1,"ng-template",36),e.qZA())}function At(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3).$implicit,i=e.oxw().rowData;e.xp6(1),e.Oqu(i[t.field])}}function It(n,s){if(1&n&&(e.YNc(0,Tt,3,0,"p-treeTableCellEditor",34),e.YNc(1,At,2,1,"span",34)),2&n){const t=e.oxw(2).$implicit,i=e.oxw().rowData;e.Q6J("ngIf",i.editing&&"instock"!=t.field&&!(1==i.type&&"price"==t.field)),e.xp6(1),e.Q6J("ngIf",!(i.editing||1==i.type&&"instock"==t.field))}}function Zt(n,s){if(1&n&&(e.YNc(0,Ct,1,2,"img",32),e.YNc(1,It,2,2,"ng-template",null,29,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw().$implicit;e.Q6J("ngIf","image"==i.field)("ngIfElse",t)}}const Rt=function(n){return{"p-toggler-column":n}};function Dt(n,s){if(1&n&&(e.TgZ(0,"td",26),e.YNc(1,xt,1,1,"p-treeTableToggler",27),e.YNc(2,vt,1,2,"p-toggleButton",28),e.YNc(3,Zt,3,2,"ng-template",null,29,e.W1O),e.qZA()),2&n){const t=s.$implicit,i=s.index,o=e.MAs(4),a=e.oxw().rowData;e.Q6J("ngClass",e.VKq(4,Rt,0===i)),e.xp6(1),e.Q6J("ngIf",0===i),e.xp6(1),e.Q6J("ngIf",0==a.type&&"instock"==t.field)("ngIfElse",o)}}function Et(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().rowData;return e.oxw().interactor.onRowEditInit(o)}),e.qZA()}}function zt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().rowData;return e.oxw().interactor.onRowEditSave(o)}),e.qZA()}}function kt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().rowData;return e.oxw().interactor.onRowEditCancel(o)}),e.qZA()}}function Ft(n,s){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Dt,5,6,"td",21),e.TgZ(2,"td",22),e.YNc(3,Et,1,0,"button",23),e.YNc(4,zt,1,0,"button",24),e.YNc(5,kt,1,0,"button",25),e.qZA(),e.qZA()),2&n){const t=s.rowData,i=s.columns;e.xp6(1),e.Q6J("ngForOf",i),e.xp6(2),e.Q6J("ngIf",!t.editing),e.xp6(1),e.Q6J("ngIf",t.editing),e.xp6(1),e.Q6J("ngIf",t.editing)}}function Ht(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-create",46),e.NdJ("saved",function(){return e.CHM(t),e.oxw().interactor.saved()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("notifierToSubmit",t.interactor.notifierToSubmit)}}function Lt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-edit",47),e.NdJ("saved",function(){return e.CHM(t),e.oxw().interactor.saved()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("notifierToSubmit",t.interactor.notifierToSubmit)("item",t.interactor.selectedItem)}}function Ot(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().interactor.cancelDialog()}),e.qZA(),e.TgZ(1,"button",49),e.NdJ("click",function(o){return e.CHM(t),e.oxw().interactor.saveDialog(o)}),e.qZA()}}function Jt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-update-image",47),e.NdJ("saved",function(){return e.CHM(t),e.oxw().interactor.saved()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("notifierToSubmit",t.interactor.notifierToSubmit)("item",t.interactor.selectedItem)}}function Nt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().interactor.cancelDialog()}),e.qZA(),e.TgZ(1,"button",49),e.NdJ("click",function(o){return e.CHM(t),e.oxw().interactor.saveImageDialog(o)}),e.qZA()}}const Qt=function(){return["name"]},V=function(){return{width:"80%"}},Bt=function(){return{width:"450px"}},Ut=new f.Yd("ListComponent");let ge=(()=>{class n{constructor(t){this.interactor=t}ngOnInit(){this.interactor.loadData(),this.interactor.subscribeRouteData(),this.viewModel=this.interactor.presenter}initDataTable(){}get value(){return this.viewModel.tableModel.value}get columns(){return this.viewModel.tableModel.columns}lazyLoad(t){Ut.debug("lazy load called")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ne))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-list"]],features:[e._Bn([x.YP,ne])],decls:20,vars:27,consts:[[1,"p-grid"],[1,"p-col-12"],[1,"card"],[1,"p-toolbar-group-left"],["label","New","icon","pi pi-plus","styleClass","p-button-success p-mr-2",3,"click"],["styleClass","p-treetable-sm",3,"value","columns","paginator","rows","lazy","globalFilterFields","totalRecords","loading","onLazyLoad","onNodeExpand"],["tt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Make an Service or Category","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Edit an Access Lelvel","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","footer"],["header","Edit image","styleClass","p-fluid",3,"visible","modal","visibleChange"],[2,"text-align","right"],[1,"pi","pi-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Global Filter",2,"width","auto",3,"input"],[3,"ngStyle",4,"ngFor","ngForOf"],[2,"width","2rem"],[3,"ngStyle"],["ttEditableColumn","",3,"ngClass",4,"ngFor","ngForOf"],[2,"text-align","center"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","class","p-button-rounded p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["ttEditableColumn","",3,"ngClass"],[3,"rowNode",4,"ngIf"],["onIcon","pi pi-check-square","offIcon","pi pi-stop",3,"disabled","ngModel","ngModelChange",4,"ngIf","ngIfElse"],["elseBlock",""],[3,"rowNode"],["onIcon","pi pi-check-square","offIcon","pi pi-stop",3,"disabled","ngModel","ngModelChange"],["style","width:32px;display:inline-block;margin:5px 0 2px 5px",3,"src","alt","click",4,"ngIf","ngIfElse"],[2,"width","32px","display","inline-block","margin","5px 0 2px 5px",3,"src","alt","click"],[4,"ngIf"],["pTemplate","input"],["pTemplate","output"],["pInputText","","type","text","style","width: 4rem;",3,"ngModel","ngModelChange",4,"ngIf"],["pInputText","","type","text","style","width: 6rem;",3,"ngModel","ngModelChange",4,"ngIf"],["rows","5","cols","10","pInputTextarea","","style","width: 13rem;height: 5rem;",3,"ngModel","ngModelChange",4,"ngIf"],["pInputText","","type","text",2,"width","4rem",3,"ngModel","ngModelChange"],["pInputText","","type","text",2,"width","6rem",3,"ngModel","ngModelChange"],["rows","5","cols","10","pInputTextarea","",2,"width","13rem","height","5rem",3,"ngModel","ngModelChange"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],[3,"notifierToSubmit","saved"],[3,"notifierToSubmit","item","saved"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"p-toolbar"),e.TgZ(4,"div",3),e.TgZ(5,"p-button",4),e.NdJ("click",function(){return i.interactor.displayCreateDialog()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"p-treeTable",5,6),e.NdJ("onLazyLoad",function(a){return i.lazyLoad(a)})("onNodeExpand",function(a){return i.interactor.onNodeExpand(a)}),e.YNc(8,mt,3,0,"ng-template",7),e.YNc(9,ft,3,1,"ng-template",8),e.YNc(10,Ft,6,4,"ng-template",9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"p-dialog",10),e.NdJ("visibleChange",function(a){return i.viewModel.isVisibleCreateDialog=a}),e.YNc(12,Ht,1,1,"ng-template",11),e.qZA(),e.TgZ(13,"p-dialog",12),e.NdJ("visibleChange",function(a){return i.viewModel.isVisibleEditDialog=a}),e.YNc(14,Lt,1,2,"ng-template",11),e.YNc(15,Ot,2,0,"ng-template",13),e.qZA(),e.TgZ(16,"p-dialog",14),e.NdJ("visibleChange",function(a){return i.viewModel.isVisibleEditImageDialog=a}),e.YNc(17,Jt,1,2,"ng-template",11),e.YNc(18,Nt,2,0,"ng-template",13),e.qZA(),e._UZ(19,"p-confirmDialog")),2&t&&(e.xp6(6),e.Q6J("value",i.value)("columns",i.columns)("paginator",!0)("rows",10)("lazy",!1)("globalFilterFields",e.DdM(22,Qt))("totalRecords",1e3)("loading",i.loading),e.xp6(5),e.Akn(e.DdM(23,V)),e.Q6J("visible",i.viewModel.isVisibleCreateDialog)("modal",!0),e.xp6(2),e.Akn(e.DdM(24,V)),e.Q6J("visible",i.viewModel.isVisibleEditDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(25,V)),e.Q6J("visible",i.viewModel.isVisibleEditImageDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(26,Bt)))},directives:[U.o,R.zx,z.iw,x.jx,u.sg,u.PC,z.R7,u.mk,u.O5,z.gc,Y.CO,m.JJ,m.On,z.Nk,m.Fj,R.Hq,q.V,ce,le,de,W.Q],styles:["[_nghost-%COMP%]     .p-cell-editing{padding-top:0!important;padding-bottom:0!important}"]}),n})();var $=p(3725);class Yt{constructor(){this.tableModel=new K,this.updatedData={},this.filteredData=[],this.isVisibleCreateDialog=!1,this.isVisibleEditDialog=!1,this.isVisibleEditImageDialog=!1,this.checked=!0}get updatedDataCount(){return Object.keys(this.updatedData).length}}const y=new f.Yd("InventoryInteractor");let he=(()=>{class n{constructor(t,i,o,a,r,c,l,d){this.router=t,this.route=i,this.serviceService=o,this.confirmationService=a,this.messageService=r,this.spinnerService=c,this.companyService=l,this.configService=d,this.notifierToSubmit=new v.x,this.presenter=new Yt}loadData(){this.presenter.tableModel.actions.push({type:"switch",label:"Active"}),this.presenter.tableModel.contextMenuItems.push({label:"Edit",icon:"pi pi-pencil",disabled:!1,command:t=>{this.displayEditingDialog(this.presenter.tableModel.contextData)}}),this.presenter.tableModel.contextMenuItems.push({label:"Delete",icon:"pi pi-times",disabled:!1,command:t=>this.confirmDeletion(this.presenter.tableModel.contextData)})}onNodeExpand(t){y.debug("onNodeExpand")}subscribeRouteData(){this.spinnerService.show(),this.route.data.subscribe(t=>{y.debug(t),this.presenter.tableModel.data=this.deepMapping(t.data.services),this.spinnerService.hide()})}deepMapping(t){return t.flatMap(i=>i.type!=b.Category?{instock:i.instock,id:i.id,name:i.name,alias:i.alias,image:i.image,number:i.number,price:i.price,type:i.type}:i.children?this.deepMapping(i.children):void 0)}confirmDeletion(t){y.debug(this.confirmationService),this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{}})}displayEditingDialog(t){this.selectedItem=t,this.presenter.isVisibleEditDialog=!0}displayCreateDialog(){this.presenter.isVisibleCreateDialog=!0}hideEditingDialog(){this.presenter.isVisibleEditDialog=!1}hideCreateDialog(){this.presenter.isVisibleCreateDialog=!1}saveDialog(t){this.notifierToSubmit.next(t)}cancelDialog(){this.presenter.isVisibleCreateDialog=!1,this.presenter.isVisibleEditDialog=!1}saved(){this.hideCreateDialog(),this.hideEditingDialog(),this.hideUpdateImageDialog(),this.reloadData()}reloadData(){this.spinnerService.show(),this.companyService.getCompany(this.router.url,"network-only").pipe((0,B.K)(t=>(y.error(t),(0,Q.c)()))).pipe((0,F.U)(t=>({services:this.deepMapping(t.company.services)}))).subscribe(t=>{y.debug(t),this.presenter.tableModel.data=t.services,this.spinnerService.hide()})}getImage(t){return null!=t?this.configService.resourceApiURI+"/ServiceImage/"+t:"assets/images/img_placeholder.png"}displayUpdateImageDialog(t){!t.editing||(this.selectedItem=t,this.presenter.isVisibleEditImageDialog=!0)}hideUpdateImageDialog(){this.presenter.isVisibleEditImageDialog=!1}saveImageDialog(t){this.notifierToSubmit.next(t)}saveRowData(t){y.debug(t)}onRowEditInit(t){t.editing=!0}onRowEditSave(t){t.editing=!1}onRowEditCancel(t){t.editing=!1}filterGlobal(t,i){y.debug(t),y.debug(i.target.value),t.filterGlobal(i.target.value,"contains")}clear(t){t.clear()}inStockChanged(t){this.presenter.updatedData[t.id]?delete this.presenter.updatedData[t.id]:this.presenter.updatedData[t.id]=t}onFilter(t,i){Object.keys(this.presenter.updatedData).forEach(o=>{this.presenter.updatedData[o].instock=!this.presenter.updatedData[o].instock,delete this.presenter.updatedData[o]}),this.presenter.checked=!0,t.filters.global?this.presenter.filteredData=t.filteredValue:this.presenter.filteredData.length=0}updateInStockForFilteredData(t){this.presenter.filteredData.forEach(i=>{i.instock=t,this.presenter.updatedData[i.id]=i})}saveChanged(){var t=Object.keys(this.presenter.updatedData).map(i=>this.presenter.updatedData[i]);y.debug(t),this.serviceService.updateServices(t).subscribe(i=>{y.debug(i),this.messageService.add({severity:"success",summary:"Success",detail:"Product is updated"})})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Z.F0),e.LFG(Z.gz),e.LFG(S.mI),e.LFG(x.YP),e.LFG(x.ez),e.LFG(k.t2),e.LFG(S.JN),e.LFG(S.E4))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var me=p(1497),ue=p(8952),_e=p(330);function qt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",19),e.TgZ(1,"span",20),e.TgZ(2,"input",21),e.NdJ("input",function(o){return e.CHM(t),e.oxw(),e.MAs(11).filterGlobal(o.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}const Wt=function(n){return{width:n}};function Vt(n,s){if(1&n&&(e.TgZ(0,"th",24),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("ngStyle",e.VKq(2,Wt,"Name"===t.header?"6rem":"2rem")),e.xp6(1),e.hij(" ",t.header," ")}}function $t(n,s){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Vt,2,4,"th",22),e._UZ(2,"th",23),e.qZA()),2&n){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function Gt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"p-toggleButton",29),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().$implicit[a.field]=o})("onChange",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw().interactor.inStockChanged(o)}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw().$implicit;e.Q6J("ngModel",i[t.field])}}function Xt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"img",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3).$implicit;return e.oxw().interactor.displayUpdateImageDialog(o)}),e.qZA()}if(2&n){const t=e.oxw(3).$implicit,i=e.oxw();e.s9C("src",i.interactor.getImage(t.image),e.LSH),e.Q6J("alt",t.name)}}function Pt(n,s){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",i[t.field]," ")}}function jt(n,s){if(1&n&&(e.YNc(0,Xt,1,2,"img",30),e.YNc(1,Pt,2,1,"ng-template",null,28,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw().$implicit;e.Q6J("ngIf","image"==i.field)("ngIfElse",t)}}const Kt=function(n){return{"p-toggler-column":n}};function ei(n,s){if(1&n&&(e.TgZ(0,"td",26),e.YNc(1,Gt,1,1,"p-toggleButton",27),e.YNc(2,jt,3,2,"ng-template",null,28,e.W1O),e.qZA()),2&n){const t=s.$implicit,i=s.index,o=e.MAs(3),a=e.oxw().$implicit;e.Q6J("ngClass",e.VKq(3,Kt,0===i)),e.xp6(1),e.Q6J("ngIf",0==a.type&&"instock"==t.field)("ngIfElse",o)}}function ti(n,s){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,ei,4,5,"td",25),e.qZA()),2&n){const t=s.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function ii(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-create",32),e.NdJ("saved",function(){return e.CHM(t),e.oxw().interactor.saved()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("notifierToSubmit",t.interactor.notifierToSubmit)}}function ni(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-edit",33),e.NdJ("saved",function(){return e.CHM(t),e.oxw().interactor.saved()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("notifierToSubmit",t.interactor.notifierToSubmit)("item",t.interactor.selectedItem)}}function oi(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw().interactor.cancelDialog()}),e.qZA(),e.TgZ(1,"button",35),e.NdJ("click",function(o){return e.CHM(t),e.oxw().interactor.saveDialog(o)}),e.qZA()}}function ai(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-update-image",33),e.NdJ("saved",function(){return e.CHM(t),e.oxw().interactor.saved()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("notifierToSubmit",t.interactor.notifierToSubmit)("item",t.interactor.selectedItem)}}function ri(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw().interactor.cancelDialog()}),e.qZA(),e.TgZ(1,"button",35),e.NdJ("click",function(o){return e.CHM(t),e.oxw().interactor.saveImageDialog(o)}),e.qZA()}}const si=function(){return["name","number"]},G=function(){return{width:"80%"}},ci=function(){return{width:"450px"}},li=new f.Yd("ListComponent");let pi=(()=>{class n{constructor(t){this.interactor=t}ngOnInit(){this.interactor.loadData(),this.interactor.subscribeRouteData(),this.viewModel=this.interactor.presenter}initDataTable(){}get value(){return this.viewModel.tableModel.value}get columns(){return this.viewModel.tableModel.columns}lazyLoad(t){li.debug("lazy load called")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(he))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-inventory"]],features:[e._Bn([x.YP,he,x.ez])],decls:26,vars:32,consts:[[1,"p-grid"],[1,"p-col-12"],[1,"card"],[1,"p-toolbar-group-left"],[2,"margin-right","20px"],["onIcon","pi pi-check-square","offIcon","pi pi-stop","binary","true",3,"ngModel","disabled","onChange","ngModelChange"],["label","Save","styleClass","p-button-success p-mr-2",3,"disabled","click"],["dataKey","id",3,"value","columns","paginator","rows","lazy","globalFilterFields","totalRecords","loading","contextMenu","onLazyLoad","onFilter"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[3,"model"],["cm",""],["header","Make an Service or Category","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Edit an Access Lelvel","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","footer"],["header","Edit image","styleClass","p-fluid",3,"visible","modal","visibleChange"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],[3,"ngStyle",4,"ngFor","ngForOf"],[2,"width","2rem"],[3,"ngStyle"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["onIcon","pi pi-check-square","offIcon","pi pi-stop",3,"ngModel","ngModelChange","onChange",4,"ngIf","ngIfElse"],["elseBlock",""],["onIcon","pi pi-check-square","offIcon","pi pi-stop",3,"ngModel","ngModelChange","onChange"],["style","width:32px;display:inline-block;margin:5px 0 2px 5px",3,"src","alt","click",4,"ngIf","ngIfElse"],[2,"width","32px","display","inline-block","margin","5px 0 2px 5px",3,"src","alt","click"],[3,"notifierToSubmit","saved"],[3,"notifierToSubmit","item","saved"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"]],template:function(t,i){if(1&t){const o=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"p-toolbar"),e.TgZ(5,"div",3),e.TgZ(6,"div",4),e.TgZ(7,"p-toggleButton",5),e.NdJ("onChange",function(r){return i.interactor.updateInStockForFilteredData(r.checked)})("ngModelChange",function(r){return i.viewModel.checked=r}),e.qZA(),e.qZA(),e.TgZ(8,"div"),e.TgZ(9,"p-button",6),e.NdJ("click",function(){return i.interactor.saveChanged()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"p-table",7,8),e.NdJ("onLazyLoad",function(r){return i.lazyLoad(r)})("onFilter",function(r){e.CHM(o);const c=e.MAs(11);return i.interactor.onFilter(r,c)}),e.YNc(12,qt,3,0,"ng-template",9),e.YNc(13,$t,3,1,"ng-template",10),e.YNc(14,ti,2,1,"ng-template",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(15,"p-contextMenu",12,13),e.TgZ(17,"p-dialog",14),e.NdJ("visibleChange",function(r){return i.viewModel.isVisibleCreateDialog=r}),e.YNc(18,ii,1,1,"ng-template",15),e.qZA(),e.TgZ(19,"p-dialog",16),e.NdJ("visibleChange",function(r){return i.viewModel.isVisibleEditDialog=r}),e.YNc(20,ni,1,2,"ng-template",15),e.YNc(21,oi,2,0,"ng-template",17),e.qZA(),e.TgZ(22,"p-dialog",18),e.NdJ("visibleChange",function(r){return i.viewModel.isVisibleEditImageDialog=r}),e.YNc(23,ai,1,2,"ng-template",15),e.YNc(24,ri,2,0,"ng-template",17),e.qZA(),e._UZ(25,"p-confirmDialog")}if(2&t){const o=e.MAs(16);e.xp6(7),e.Q6J("ngModel",i.viewModel.checked)("disabled",0==i.viewModel.filteredData.length),e.xp6(2),e.Q6J("disabled",0==i.viewModel.updatedDataCount),e.xp6(1),e.Q6J("value",i.value)("columns",i.columns)("paginator",!0)("rows",1e3)("lazy",!1)("globalFilterFields",e.DdM(27,si))("totalRecords",1e3)("loading",i.loading)("contextMenu",o),e.xp6(5),e.Q6J("model",i.viewModel.tableModel.contextMenuItems),e.xp6(2),e.Akn(e.DdM(28,G)),e.Q6J("visible",i.viewModel.isVisibleCreateDialog)("modal",!0),e.xp6(2),e.Akn(e.DdM(29,G)),e.Q6J("visible",i.viewModel.isVisibleEditDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(30,G)),e.Q6J("visible",i.viewModel.isVisibleEditImageDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(31,ci))}},directives:[me.FN,U.o,Y.CO,m.JJ,m.On,R.zx,ue.iA,x.jx,u.sg,u.PC,u.mk,u.O5,_e.xV,q.V,ce,le,R.Hq,de,W.Q],styles:[""]}),n})();new f.Yd("TabComponent");const di=[{path:"",pathMatch:"full",redirectTo:"list"},{path:"list",component:(()=>{class n{constructor(t){this.route=t,this.listComponent=null}ngAfterViewInit(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Z.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tab"]],viewQuery:function(t,i){if(1&t&&e.Gf(ge,5),2&t){let o;e.iGM(o=e.CRH())&&(i.listComponent=o.first)}},decls:5,vars:0,consts:[["header","Header 1"],["header","Header 2"]],template:function(t,i){1&t&&(e.TgZ(0,"p-tabView"),e.TgZ(1,"p-tabPanel",0),e._UZ(2,"app-list"),e.qZA(),e.TgZ(3,"p-tabPanel",1),e._UZ(4,"app-inventory"),e.qZA(),e.qZA())},directives:[$.xf,$.x4,ge,pi],styles:[""]}),n})(),resolve:{data:Le}}];let fe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[Z.Bz.forChild(di)],Z.Bz]}),n})();var gi=p(9397),hi=p(7102),mi=p(242),ui=p(4119),_i=p(1075);let fi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[R.hJ,W.D,u.ez,_i.XH,_e.vI,q.S,gi.m8,U.V,m.u5,m.UX,oe.cc,hi.Qy,Y.KZ,mi.Iu,ht,ui.z,z.dp,re.xc,$.LU,ue.U$,me.EV,fe]]}),n})()}}]);